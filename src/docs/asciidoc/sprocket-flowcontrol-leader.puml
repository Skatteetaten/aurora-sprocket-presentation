@startuml
scale 600 height
!include skatt.iuml
skinparam  BackgroundColor white






database KubernetesP<<kubernetes>> [
prod
]

database KubernetesU<<kubernetes>> [
utv
]

database KubernetesT<<kubernetes>> [
test
]

rectangle BuildCog<<leader>>
rectangle DeployProdCog<<leader>>
rectangle DeployTestCog<<leader>>
rectangle DeployUtvCog<<leader>>

database ResourceQueue<<sprocket>>

interface ExternalService

BuildCog --> ResourceQueue : 1.fetch affected builds
BuildCog --> KubernetesU : 2. start builds

DeployProdCog --> ResourceQueue : 1. fetch deploys for prod
DeployProdCog -right-> ExternalService: 2. onUpdateHook
DeployProdCog -down-> KubernetesP : 3. deploy

DeployTestCog -up-> ResourceQueue : 1. fetch deploys for test
DeployTestCog --> KubernetesT : 2. deploy

DeployUtvCog -up-> ResourceQueue : 1. fetch deploys for utv
DeployUtvCog --> KubernetesU : 2. deploy

@enduml